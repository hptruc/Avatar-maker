var app={};app.avatarCreator=function(a){function t(){c.change(function(a){var t=e(a.target.value);u.val(t),f=a.target.files[0]}),l.change(function(a){var t=e(a.target.value);v.val(t),h=a.target.files[0]}),g.on("click",function(){NProgress.start(),NProgress.set(.5);var a=i();a&&a.length>0&&(alert(a),NProgress.done())}),s.on("click",function(){var a=document.getElementById("final-avatar");if(!r(a)){var t=a.toDataURL();download(t,m,"image/png")}})}function e(a){return a.replace(/^.*[\\\/]/,"")}function n(){return!(!f||!h)&&("image"===f.type.split("/")[0]&&"image"===h.type.split("/")[0])}function r(a){var t=document.createElement("canvas");return t.width=d,t.height=p,a.toDataURL()===t.toDataURL()}function i(){var a=document.getElementById("final-avatar"),t=a.getContext("2d");if(!n())return I.INPUT_FILES;var e=[URL.createObjectURL(h),URL.createObjectURL(f)],r=[],i=e.length;$.each(e,function(){var a=new Image;r.push(a),a.onload=function(){i--,i||($.each(r,function(a){if(0===a){var e=o(this.width,this.height);t.drawImage(this,e[0]/2,e[1]/2,this.width-e[0],this.height-e[1],0,0,d,p)}else t.drawImage(this,0,0,d,p)}),NProgress.done())},a.src=this})}function o(a,t){var e=[];return a>t?(e[0]=a-t,e[1]=0):(e[0]=0,e[1]=t-a),e}var c=$("#avatar-frame-btn"),u=$("#avatar-frame-path"),l=$("#avatar-btn"),v=$("#avatar-path"),g=$("#avatar-generate"),s=$("#avatar-download"),f=null,h=null,d=1024,p=1024,m="Avatar.png",I={INPUT_FILES:"Input files are incorrect!",UNKNOWN:"Error! Please try again."};return a.initialize=function(){t()},a}(app),$(document).ready(function(){app.avatarCreator.initialize()});